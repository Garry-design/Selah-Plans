<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Selah Plans | Plans</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;500;700&family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <nav class="site-nav">
        <a class="nav-brand" href="index.html">Selah Plans</a>
        <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="about.html">About</a>
          <a href="services.html">Services</a>
          <a class="active" href="plans.html">Plans</a>
          <a href="contact.html">Contact</a>
        </div>
      </nav>

      <header class="hero">
        <div class="hero-text">
          <div class="brand-lockup" aria-label="Brand">
            <svg class="brand-logo" viewBox="0 0 64 64" role="img" aria-hidden="true">
              <circle cx="32" cy="32" r="30"></circle>
              <path d="M20 22h24v20H20z"></path>
              <path d="M32 18v28"></path>
            </svg>
            <span class="brand-name">Selah Plans</span>
          </div>
          <p class="eyebrow">Plans</p>
          <h1>Build and follow your Bible plan</h1>
          <p class="subtitle">Choose built-in mood plans or generate fully customized plans, then save by account.</p>
        </div>
        <div class="hero-card">
          <div class="card-top">
            <span>Today</span>
            <strong id="today-date">Thursday, Feb 5</strong>
          </div>
          <div class="card-body">
            <h3 id="hero-plan-title">Peace 7 Day Reset</h3>
            <p id="hero-plan-description">Read and pray through a short, focused day with practical reflection.</p>
          </div>
          <div class="card-footer">
            <span id="hero-plan-time">Estimated time: 10 min</span>
          </div>
        </div>
      </header>

      <main>
        <section id="overview" class="section">
          <div class="section-header">
            <h2>Overview</h2>
            <p>Live statistics for your available plans and saved progress.</p>
          </div>
          <div class="stats-grid">
            <article class="stat-card">
              <p class="stat-label">Moods</p>
              <h3 id="stat-moods">0</h3>
            </article>
            <article class="stat-card">
              <p class="stat-label">Built-in plans</p>
              <h3 id="stat-plans">0</h3>
            </article>
            <article class="stat-card">
              <p class="stat-label">Saved plans</p>
              <h3 id="stat-saved">0</h3>
            </article>
            <article class="stat-card">
              <p class="stat-label">Daily range</p>
              <h3>3 to 30 days</h3>
            </article>
          </div>
        </section>

        <section id="account" class="section">
          <div class="section-header">
            <h2>Account</h2>
            <p>Create an account or log in to save plans under your profile.</p>
          </div>
          <div class="tool-layout">
            <article class="panel">
              <h3>Create account</h3>
              <label>
                Name
                <input id="auth-register-name" type="text" placeholder="Your name" />
              </label>
              <label>
                Email
                <input id="auth-register-email" type="email" placeholder="you@example.com" />
              </label>
              <label>
                Password
                <input id="auth-register-password" type="password" placeholder="Minimum 6 characters" />
              </label>
              <div class="action-row">
                <button id="register-btn" class="btn primary" type="button">Create account</button>
              </div>
            </article>
            <article class="panel">
              <h3>Log in</h3>
              <label>
                Email
                <input id="auth-login-email" type="email" placeholder="you@example.com" />
              </label>
              <label>
                Password
                <input id="auth-login-password" type="password" placeholder="Password" />
              </label>
              <div class="action-row">
                <button id="login-btn" class="btn primary" type="button">Log in</button>
                <button id="logout-btn" class="btn ghost" type="button">Log out</button>
              </div>
              <p id="auth-status" class="muted"></p>
            </article>
          </div>
        </section>

        <section id="plans" class="section">
          <div class="section-header">
            <h2>Pick a mood plan</h2>
            <p>Search moods, filter by intent, and choose from multiple built-in plans per mood.</p>
          </div>

          <div class="toolbar">
            <label class="search-field">
              Mood search
              <input id="mood-search" type="text" placeholder="Search moods..." />
            </label>
            <div id="mood-filter" class="filter-row">
              <button type="button" class="chip active" data-filter="all">All</button>
              <button type="button" class="chip" data-filter="comfort">Comfort</button>
              <button type="button" class="chip" data-filter="growth">Growth</button>
              <button type="button" class="chip" data-filter="prayer">Prayer</button>
              <button type="button" class="chip" data-filter="wisdom">Wisdom</button>
            </div>
          </div>

          <div id="mood-grid" class="plan-grid"></div>

          <div class="picker-layout">
            <div class="panel">
              <h3>Plans for selected mood</h3>
              <div id="built-in-plan-list" class="list-grid"></div>
            </div>
            <div class="panel">
              <div class="plan-viewer-header">
                <h3 id="viewer-plan-title">Plan viewer</h3>
                <button id="start-plan-btn" class="btn primary" type="button">Start this plan</button>
              </div>
              <div id="plan-viewer" class="plan-viewer">
                <p class="placeholder">Choose a built-in plan to preview and start.</p>
              </div>
              <div class="nav-row">
                <button id="prev-day-btn" class="btn ghost" type="button">Previous</button>
                <button id="mark-complete-btn" class="btn ghost" type="button">Mark complete</button>
                <button id="next-day-btn" class="btn ghost" type="button">Next</button>
              </div>
              <div class="action-row">
                <button id="save-active-btn" class="btn ghost" type="button">Save current plan</button>
              </div>
            </div>
          </div>
        </section>

        <section id="generator" class="section alt">
          <div class="section-header">
            <h2>Custom plan generator</h2>
            <p>Generate, edit, regenerate specific days, save to local storage, export, and import plans.</p>
          </div>
          <div class="generator">
            <form id="generator-form" class="generator-form">
              <label>
                Plan name
                <input id="plan-name-input" type="text" value="My Custom Plan" />
              </label>
              <label>
                Mood
                <select id="mood-select"></select>
              </label>
              <label>
                Duration
                <select id="duration-select">
                  <option value="3">3 days</option>
                  <option value="5">5 days</option>
                  <option value="7" selected>7 days</option>
                  <option value="10">10 days</option>
                  <option value="14">14 days</option>
                  <option value="21">21 days</option>
                  <option value="30">30 days</option>
                </select>
              </label>
              <label>
                Minutes per day
                <select id="minutes-select">
                  <option value="5">5</option>
                  <option value="10" selected>10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
                  <option value="30">30</option>
                </select>
              </label>
              <label>
                Bible focus
                <select id="bible-focus-select">
                  <option value="psalms">Psalms</option>
                  <option value="gospels">Gospels</option>
                  <option value="proverbs">Proverbs</option>
                  <option value="letters">Letters</option>
                  <option value="wholeBible" selected>Whole Bible</option>
                </select>
              </label>
              <label>
                Output style
                <select id="output-style-select">
                  <option value="gentle">Gentle</option>
                  <option value="balanced" selected>Balanced</option>
                  <option value="challenge">Challenge</option>
                </select>
              </label>
              <fieldset id="theme-emphasis-group" class="topic-group">
                <legend>Theme emphasis</legend>
              </fieldset>
              <button class="btn primary" type="submit">Generate</button>
            </form>

            <div class="generator-output">
              <div class="output-header">
                <h3>Your generated plan</h3>
                <div class="output-actions">
                  <button id="copy-btn" class="btn ghost" type="button">Copy</button>
                  <button id="export-compact-btn" class="btn ghost" type="button">Export compact JSON</button>
                  <button id="download-btn" class="btn ghost" type="button">Download JSON</button>
                  <button id="save-generated-btn" class="btn ghost" type="button">Save</button>
                </div>
              </div>
              <div id="plan-output" class="plan-output">
                <p class="placeholder">Generate a plan to edit day-by-day entries here.</p>
              </div>
            </div>
          </div>
        </section>

        <section id="saved" class="section">
          <div class="section-header">
            <h2>Saved plans</h2>
            <p>Saved plans are tied to your logged-in account in this browser.</p>
          </div>
          <div id="saved-plans-list" class="list-grid"></div>

          <div class="panel">
            <h3>Import plan JSON</h3>
            <textarea id="import-json" class="json-box" placeholder="Paste plan JSON here"></textarea>
            <div class="action-row">
              <button id="import-btn" class="btn primary" type="button">Import and save</button>
              <p id="import-message" class="muted"></p>
            </div>
          </div>
        </section>

        <section id="tools" class="section alt">
          <div class="section-header">
            <h2>Daily tools</h2>
            <p>Quick daily tools to support your plan rhythm.</p>
          </div>
          <div class="tool-layout">
            <article class="panel">
              <h3>Random verse focus</h3>
              <p id="verse-display" class="muted">Tap for a verse reference to reflect on right now.</p>
              <div class="action-row">
                <button id="new-verse-btn" class="btn primary" type="button">New verse</button>
                <button id="copy-verse-btn" class="btn ghost" type="button">Copy verse ref</button>
              </div>
            </article>
            <article class="panel">
              <h3>Daily check-in</h3>
              <label>
                Mood today
                <select id="checkin-mood"></select>
              </label>
              <label>
                Journal note
                <textarea id="checkin-note" rows="4" placeholder="Write a short prayer or reflection..."></textarea>
              </label>
              <div class="action-row">
                <button id="save-checkin-btn" class="btn primary" type="button">Save check-in</button>
                <button id="load-checkin-btn" class="btn ghost" type="button">Load last</button>
              </div>
              <p id="checkin-message" class="muted"></p>
            </article>
          </div>
        </section>
      </main>

      <footer class="footer">
        <p>Selah Plans</p>
      </footer>
    </div>

    <script>
      (function () {
        var version = "v=20260214-3";
        function loadWithFallback(candidates, onDone) {
          var idx = 0;
          function tryNext() {
            if (idx >= candidates.length) {
              console.error("Failed to load script:", candidates.join(" | "));
              var msg = document.createElement("div");
              msg.style.margin = "12px 0";
              msg.style.padding = "10px 12px";
              msg.style.borderRadius = "10px";
              msg.style.background = "#f6d5d2";
              msg.style.color = "#3a0f0b";
              msg.textContent = "Plans failed to load. Please hard refresh (Ctrl/Cmd+Shift+R).";
              document.body.prepend(msg);
              return;
            }
            var script = document.createElement("script");
            script.src = candidates[idx] + (candidates[idx].includes("?") ? "&" : "?") + version;
            idx += 1;
            script.onload = function () {
              onDone();
            };
            script.onerror = function () {
              script.remove();
              tryNext();
            };
            document.body.appendChild(script);
          }
          tryNext();
        }

        loadWithFallback(["data/plans.js", "app/data/plans.js"], function () {
          loadWithFallback(["app.js", "app/app.js"], function () {});
        });
      })();
    </script>
  </body>
</html>
